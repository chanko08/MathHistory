\documentclass[11pt]{article}
%\usepackage[margin=1.5in]{geometry}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{bold-extra}
\usepackage{graphicx}
\usepackage{algorithm}
\usepackage{algpseudocode}

\title{Fermat's Work and Contributions to Number Theory}
\author{Alex Bechanko}
\begin{document}
\maketitle
There are many things that Fermat is famous for today, but by far his most widely
known research was in Number Theory, namely Fermat's Little Theorem, and 
Fermat's Last Theorem.
This paper will discuss some of his lesser
known contributions to Number Theory, which includes the exploration of
Perfect numbers, as well as the primality of numbers.
We will also go over one of his more commons methods for proving general results,
the proof by infinite descent.
His little theorem will also be thoroughly explained, including several 
interesting primality results that require his theorem.
There will also be discussion regarding how Fermat's work in number
theory was regarded to other mathematicians at the same time period, as
well as further on into the future. 


\section*{Introduction}
Fermat is widely regarded as having created modern number theory.
Most mathematicians of Fermat's time were focused
on topics in mathematics such as slopes of curves and areas under curves.
There were not many that chose to take a step back, and look at 
results from the greecian times with the lens of results from the
renaissance to focus in on different areas of mathematics obtained by greecians \cite{Mahoney}. 
Despite what results Fermat obtained, it is interesting to note that there were
not many people that were interested in his work related to number theory.
The efforts that Fermat made to make his number theory results known were fairly
ineffective, as most of his correspondents were not interested in this new field of
mathematics he was creating.
As a result, most of his methods for number theory are very difficult or
impossible to obtain
for this day and age by historians, because he only outlined
his results for these topics to the many correspondents that he wrote
to.
One of the only other places historians were able to find results of his was in
his copy of \emph{Arithmetica} written by Diophantus.
In fact, even once interest was sparked in his results a century or so later,
only his results were able to be found, and not his methods.
So later mathematicians found it much easier to create their own methods
instead of recreating his \cite{Mahoney}.

\section*{Exploration of Perfect Numbers and Primality}
\subsection*{Perfect Numbers}
One of Fermat's first correspondents was the Marin Mersenne, who was said to be
the center of of mathematics in the 16th century \cite{Mersenne}.
Mersenne had heard of Fermat even before this correspondence, in particular it
was Fermat's observations of the divisibility of numbers that had garnered 
Mersenne's attention.
Including this was perfect numbers, and their relations to prime
numbers \cite{Mahoney}.
Perfect numbers are numbers whose proper positive divisors add up to
themselves \cite{PerfectNumbers}.
Equivalently, you could say that a number is perfect if its positive divisors
add up to twice the number.
A simple example of a perfect number would be 6, whose proper divisors are
1,2, and 3, which sum to 6.

There were a few reasons for mathematicians interest in perfect numbers.
The first reason was that while there was a way to generate perfect numbers,
the way to generate them itself was a very difficult process.
In particular, in Euclid's \emph{Elements} has the following result.
If $2^{n+1} - 1$ is prime, then \[ 2^n(2^{n+1} - 1)\]
is a perfect number \cite{Euclid,Mahoney}.
So the perfect number problem had transformed into methods for
finding prime numbers.


\subsection*{Mersenne Primes}
It is through the emphasis on the topic of primality that Fermat had garnered the
attention of a less well-known number theorist named
Bernard Frenicle de Bessy \cite{Mahoney}.
It was previously said that Fermat tended to hold his methods for finding many
of his results to himself, but thanks to the correspondence with Bernard we
know some of the methods Fermat used to determine primality of numbers.
The first proposition he gave was this.
Given a positive integer $n$, if $n$ is composite, then $2^n - 1$ is also 
composite.
Indeed this can be shown with a direct factoring.
Let $n = ab$, then
\[2^{ab} - 1 = (2^a - 1)(1 + 2^a + 2^{2a} + \dots +2^{(b-1)a} ). \]
The next proposition that he showed in his correspondence was that given a 
positive integer $p$, if $p$ is an odd prime then $2p$ divides $2^p-2$.
Put in a simpler way, if $p$ is an odd prime then $p$ divides $2^{p-1} - 1$.
Indeed, this is an application of Fermat's little theorem, however it is thought
that Fermat had not yet developed the general theorem \cite{Ball, Mahoney}.
Finally, Fermat also stated in his correspondence with Bernard that given an
integer $p$, if $p$ is an odd prime then the only divisors of $2^p -1$ are of
the form $2pk +1$ for some integer $k$.
Again, this was another application of Fermat's little theorem, but to get a list
of candidates fo factors of $2^p-1$ \cite{MersennePrime}.
Later on, mathematicians and historians alike would come to know prime numbers
of the form $2^p -1$ as Mersenne primes, despite the fact that it was Fermat
that first brought light onto these type of numbers \cite{Mahoney}.
Admittedly, the main reason for this was due to Fermat's naming a different set
of numbers after himself.
Mersenne numbers were named after Marin Mersenne, who continued working on
this form of numbers after his correspondence with Fermat.


\subsection*{Fermat's Little Theorem}
Later in Fermat's correspondence with Bernard and Mersenne, he finally divulged
that he had a general theorem with which he was deriving some of his results.
However, the form is a bit different to what we see today \cite{Mahoney}: 
    \begin{quote}
        Without exception, every prime number measures one of the powers $- 1$    
        of any progression whatever, and the exponent of the said power is a
        submultiple of the given prime number $-1$.
        Also, after one has found the first power that satisfies the problem,
        all those which the exponents are multiples of the exponent of the first
        will satisfy the problem.
    \end{quote}
Perhaps it is a little cryptic, but in a more succinct form, he is saying that
given a prime $p$, and a sequence of $a^t - 1$ where $a$ and $t$ are positive
integers, then $p$ divides at least one member of that sequence, and $t$ divides
$p-1$.
He then goes on to say that $p$ will divide all members of the sequence of the
form $a^{tk} - 1$ for all positive integers $k$.
In modern notation, if $p$ is prime and any integer $a$,
\[a^p \equiv a \pmod{p}. \]
Fermat only spoke of this theorem in this letter to Bernard, and probably due to
the shift in interests towards Pythagorean triples, there was no one pressing
to have Fermat give his proof, or at least an outline of the proof.


\subsection*{Fermat Numbers}
As discussed earlier, despite having been the first mathematician documented to
have researched Mersenne Primes, these numbers were not given Fermat's name due to the existence
of a different set of numbers that were named after Fermat.
A Fermat number is a number of the form $2^{2^n} +1$.
This number arose from his work with Mersenne numbers, and indeed as he
researched them he conjectured that all Fermat numbers are prime numbers.
Indeed, because of how quickly Fermat numbers grow in size he could only
test for cases $0,1,2,3,4$, which are
    \[\{3, 5, 17, 257, 65537\}. \]
Later mathematicians would show that not all Fermat numbers were primes.
This is interesting because Fermat was resolute on it being true,
and had tried many times to prove this result.
It was only later in the late 17th century that Leonhard Euler showed that the
this conjecture was not true by giving a factorization of the 5th case,
    \[2^{2^5}+1 = 4294967297 = 641 \cdot 6700417. \]
Fermat even stated in multiple letters to Mersenne of his confidence of this
conjecture, as well as the frustration with finding a proof for
this result \cite{Mahoney, Ball}.
It is conjectured by a few historians/mathematicians that Fermat had used some
form of a proof by infinite descent to help prove his conjecture, but there is
nothing stated in the letters about this to Bernard or Mersenne.
Another possibility on how he got this result wrong was that he was notoriously
bad at structuring his results so that others could understand it,
so it is conjectured that he made some errors in his process through the
notes he kept for himself as well.


\section*{Rediscovery of the Proof \emph{Descente Infinie}}
Before Fermat, there were Greek mathematicians that used this proof method.
One such example if the Greek mathematician Hippasus of Metapontum, who
used this method to prove the irrationality of the golden number
$\frac{1}{2}(1+\sqrt{5})$ \cite{Wirth}.
One of the peculiarities of Fermat was that he was one of the few of his time
to regularly use the proofing method called proof \emph{descente infinie}, or
proof by infinite descent.
The proof by infinite descent is a proof method that aims to prove the negation
of a claim.
To do this you would assume that the opposite holds for some arbitrary
positive integer value.
If you could infer from this value that a smaller value existed, then you could
reach the conclusion that there are infinitely many such smaller values.
However, this would be a contradiction, because there are not an infinite number
of positive integers below any specified positive integer, and thus the claim
would be not true.

We first learn of Fermat's use of this proof method from his correspondence
with a man named Christiaan Huygens \cite{Mahoney, Wirth}.
Christiaan was, among other things, a well known Dutch mathematician.
One of his well-known works was the first book
on probability theory called \emph{De ratiociniis in ludo aleae} \cite{Huygens}.
Fermat wrote an example of this method to Christiaan in response to Christiaan's
curiosities of his methods \cite{Mahoney}:

\begin{quotation}
    If there were any right triangle that had an area equal to a square,
    then there would be another triangle less than that one which would
    have the same property.
    If there were a second less than the first which had the same property,
    there would by similar reasoning be a third less than the second
    which would have the same property, and then a fourth, a fifth, etc.,
    descending \emph{ad infinitum}.
    Now it is the case that, given a number, there are not infinitely many
    numbers less than that one in descending order (I mean always to speak in
    integers). 
    Whence one concludes that there is a square \ldots

    I do not add the reasoning by which I infer that, if there was a right
    triangle of that nature, there would be another of the same nature less
    than the first, because the argument would be too long and because that is
    the whole mystery of my method.
    I will be content if the Pascals and Robervals and so many learned men
    search for it according to my indications.
\end{quotation}

So as per Fermat's way of speaking with his correspondents, he left showing that
the method worked as an exercise for them to work out.

Later, Fermat's copy of 
Diophantus' \emph{Arithmetica} would be published by his son,
and in it they would find one of the few proofs
that they would ever find written by Fermat \cite{Wirth}.
The result that he proved with this method was that if a triangle has integer
side lengths, then the area of the triangle can not be represented by a square
with integer side length.
More succinctly, if $x_0,x_1 \in \mathbf{N}$ and $x_2,x_3 \in \mathbf{N}$ and
and $x_0^2 + x_1^2 = x_2^2$, then \[\frac{x_0x_1}{2} \neq x_3^2. \]
The way Fermat writes this proof is similar to how he writes to his correspondents,
that is he leaves many parts left to the reader to prove if they do not believe
Fermat's assertions \cite{Wirth}.


\section*{Fermat's Last Theorem}
Fermat's most infamous result is his last theorem.
As quoted by Fermat in his copy of
Diophantus' \emph{Arithmetica} \cite{Kleiner}:
\begin{quote}
    It is impossible to separate a cube into two cubes, or a fourth power into
    two fourth powers or, in general, any power greater than the second into
    powers of like degree. I have discovered truly marvellous demonstration,
    which this margin is too narrow to contain.
\end{quote}
The reason this theorem is so infamous is due the last line of this quote, as
well as how elusive of a result it was.
Fermat's last theorem got its name due to it being Fermat's last unproven
theorem.
Every other result that Fermat did not give a proof for was proven by other 
mathematicians of the 16th or 17th century such as Lagrange or Euler, but this
result was the only one of Fermat's to elude these famous
mathematicians until modern day \cite{Kleiner}.

There is quite an interesting history to Fermat's Last Theorem.
While historians found no trace Fermat's proof of this result, they did find
a proof showing this result for fourth powers using a proof by infinite descent.
For over one hundred years this problem remained an open one until Leonhard
Euler attempted to solve it.
Unfortunately, he too was unable to give a generalized result, but he was able
to make a proof for the cubic version.
Later on, closer to the end of the 18th century, the Paris Academy announced that
they would reward the person to solve this problem.
Around 1825, other famous mathematicians such as Johann Dirichlet and 
Adrian-Marie Legendre found that this theorem held for powers of five and seven.
It wasn't until the mathematician Sophie Germain worked on this problem that
a more powerful theorem came out.
Sophie Germain proved that given an integer $p$, if $p$ and $2p+1$ are prime,
then $x^p + y^p = z^p$ has no solutions for which $xyz$ is divisible by $p$.
Due to this result, proofs of Fermat's last theorem were divided into two parts;
the case where at least one of $x,y,z$ are divisible by a prime $p$ and where
none of them are divisible by $p$ \cite{Kleiner}.

It wasn't until a relation was found between Fermat's last theorem and elliptic
curves that a bridge to a general proof would be found \cite{Kleiner}.
Once a relation to elliptic curves was found, another connection called the
Taniyama-Shimura conjecture was found, which was proven to be closely connected to
Fermat's last theorem.
The Taniyama-Shimura conjecture is a result that connects topology and number
theory.
At a high level overview, it states that every rational elliptic curve is a
modular form in disguise, where a modular form is a term to describe a function
in topology.
It turns out that Fermat's last theorem was so connected to this conjecture,
that it was proven by Ken Ribet that the Taniyama-Shimura conjecture implied
that Fermat's last theorem \cite{Kleiner}.

At this point, Andrew Wiles became interested in proving Fermat's Last
Theorem \cite{Kleiner}.
\begin{quote}
    It was one evening at the end of summer of 1986 when I was sipping tea
    at the house of a friend.
    Casually in the middle of the conversation he told me that Ken Ribet had
    proved the link between Taniyama-Shimura and Fermat's Last Theorem.
    I was electrified.
    I knew that moment that the course of my life was changing because this
    meant that to prove Fermat's Last Theorem all I had to do was to
    prove the Taniyama-Shimura conjecture.
    It meant that my childhood dream was now a respectable thing to work on.
    I knew that I would go home and work on the Taniyama-Shimura conjecture.
\end{quote}
It would take seven years of working on this problem for Wiles to build up a
proof of the Taniyama-Shimura conjecture.
Once he had a proof built up, and because of timing, Wiles scheduled three
lectures at a conference in Cambridge title \emph{Elliptic Curves, modular forms, and
Galois Representations}.
And so he started a lecture that nobody knew would lead to this proof until the
third lecture day.
What Wiles had proven was that the Taniyama-Shimura conjecture holds for a certain
class of elliptic curves called semi-stable elliptic curves \cite{Kleiner}.

Unfortunately, Wiles' initial proof was reviewed by a board of mathematicians, and
was found to have a nontrivial gap that needed to be filled.
It wasn't until a year later that with the help of his former PhD student 
Richard Taylor that he was able to publish a complete \cite{Kleiner}.


\section*{Primality Tests Based off Fermat's Work}
In the field of number theory, Fermat's theorems and conjectures have really
helped galvanize the field into existence.
At the very least Fermat's last theorem has helped provide one goal to be achieved
by mathematicians, and as a result large portions of number theory have been developed
as well as other fields in mathematics.
Here we discuss some of the applications of the number theoretic
results that Fermat made in his lifetime.
Since we make a focus of the primality and perfect number results for Fermat, we
will also focus on results and applications formed around those results.


\subsection*{Fermat Primality Test}
One application of Fermat's little theorem is the Fermat primality test.
As the name describes it is an algorithm for determining primality.
To understand the concept, we review Fermat's little theorem, which
states that if an integer $p$ is prime, and given
another integer $a$ where $1 \le a \le p$, then \[a^p \equiv a \pmod{p}. \]
So to be confident that $p$ is prime, we can test to see if many different integers
hold this relation given the number $p$.
Keep in mind that this test is what is called a probabilistic test, so
this test does not guarantee that $p$ is prime.
If there was a number $a$ where this test fails, the it can be inferred that $p$ is
composite.
While you could test the full range of $a$ values for any possible prime $p$,
this would be a slow way to do it.
Instead, try for a some number of $a$ values, if Fermat's little theorem holds
for those values of $a$ and $p$, then it is more likely that $p$ is prime.
Even then, there is the possibility of having a number $p$ that holds 
Fermat's little theorem, and is not a prime number.
One such number is 561, but there are an infinite amount of these
numbers \cite{FermatTest}.
Hence, this test is a probabilistic test, as you can not guarantee that a number
is prime by using this test, only increase the chances.
A basic algorithm is listed below \cite{FermatTest}:

\begin{algorithm}
\begin{algorithmic}[0]
    \Procedure{Fermat}{$p$}
        \For{$k$ times}
            \State Pick random $a$ so that $1 \le a < p$.
            \If{$a^p \not\equiv a \pmod{p}$}
            \State \textbf{return} \emph{not prime}
            \EndIf
        \EndFor
        \State \textbf{return} \emph{probably prime}
    \EndProcedure
\end{algorithmic}
\end{algorithm}

So this is a really simple algorithm to create to do a quick check for 
compositeness if you require.

There is a similar but more powerful test
called the Miller-Rabin primality test.
The way the Miller-Rabin test is similar to how the Fermat test works,
but there are a few key differences.
The first difference is that the Miller-Rabin test relies on
\begin{equation}
    x^2 -1 \equiv (x-1)(x+1) \pmod{p} \label{miller1}
\end{equation}
being true for prime numbers $p$ \cite{Miller}.
Note that this implies that $x$ is either congruent to $1$ or $-1$ modulo $p$.
The second key difference is that it uses Fermat's little theorem in a slightly
different way.
If we test only odd numbers $n$ for primality, then we know that $n-1$ can be
decomposed into the form $2^sd$, where $d$ is odd and $s >0$.
If $p$ is prime and we take square roots of this number, we should expect that
the square roots should still be either $-1$ or $1$.
Thus, if we can find a value $a$ so that its square roots are neither $1$ or $-1$,
then $p$ can not be prime because it does not hold equation \eqref{miller1}.
Here is an example algorithm for testing primality with the Miller-Rabin test.

\begin{algorithm}[H]
\begin{algorithmic}[0]
    \Procedure{Miller-Rabin}{$p$}
    \State Find integers $s$ and $d$ so that $n-1 = 2^sd$.
    \For{$k$ times}
        \State Pick random $a$ so that $1 \le a \le n-2$.
        \If{$a^d \equiv 1 \pmod{p}$ or $a^d \equiv -1 \pmod{p}$}
            \State Try the next value for $a$
        \EndIf
        \State Let $x = a^d \pmod{p}$
        \For{$r=1$ to $s-1$}
            \State Let $x = x^2 \pmod{p}$ 
            \If{$x \equiv 1 \pmod{p}$}
                \State \textbf{return} \emph{composite}
            \ElsIf{$x \equiv -1 \pmod{p}$}
                \State Try the next value for $a$
            \EndIf
        \EndFor
        \State \textbf{return} \emph{composite}
    \EndFor
    \State \textbf{return} \emph{probably prime}
    \EndProcedure
\end{algorithmic}
\end{algorithm}

While clearly this is more complex of an algorithm, it also is a much
better algorithm than the Fermat test due to this algorithm's method of testing.
Also, there is a version of the Miller-Rabin test that is deterministic.
That is, it can completely determine whether a number is prime or composite.
That version relies on the unproven Riemann Hypothesis however.

\subsection*{Lucas-Lehmer}
We now move onto a different primality test called the Lucas-Lehmer test.
This primality test is used specifically for testing Mersenne numbers, numbers
of the form $2^p -1$ \cite{MersennePrimeTests}.
Unlike the previous tests, this test is a deterministic test.
The main argument of the Lucas-Lehmer test is that if a number $p$ is prime, than
its Lucas-Lehmer residue is 0.
This residue is defined with the sequence $S$ where
\[S_k = \begin{cases} 4 &\text{if } i=0\\ S^2_{k-1} -2 &\text{otherwise}\end{cases}\]
and the residue is $S_{p-2} \pmod{M_p}$, where $M_p$ is
the $p$th Mersenne number \cite{wLucasLehmerTest}.
Something interesting to note is that test is still being used for finding
large primes by many groups \cite{qLucasLehmerTest}.
A relatively understandable algorithm follows:

\begin{algorithm}[H]
\begin{algorithmic}
    \Procedure{Lucas-Lehmer}{$n$}
    \State Let $M_n=2^n-1$
    \State Let $s=4$
    \For{$i=1$ to $p-2$}
        \State Let $s$ be $s^2 - 2 \pmod{M_n}$
    \EndFor
    \If{$s \equiv 0 \pmod{M_n}$}
        \State \textbf{return} \emph{prime}
    \EndIf
    \State \textbf{return} \emph{composite}
    \EndProcedure
\end{algorithmic}
\end{algorithm}
As the algorithm makes really obvious, the expensive part of this algorithm is
calculating the residue.

\section*{Conclusion}
While Fermat's documented contributions to number theory were smaller in number
than the other areas he contributed, the amount that he did contribute 
started the completely new field of number theory.
He was both an interesting and unique mathematician for the 16th century.


\begin{thebibliography}{9}
\bibitem{Ball}
    Ball, W. W. Rouse. \emph{A Short Account of the History of Mathematics}. New York: Dover, 1960. Print.

\bibitem{Mahoney}
    Mahoney, Michael S. \emph{The Mathematical Career of Pierre De Fermat, 1601-1665}. Princeton, NJ: Princeton UP, 1994. Print.

\bibitem{Wirth}
    Wirth, Claus-Peter.
    \emph{A Self-Contained and Easily Accessible Discussion of the Method of Descente Infinie and Fermat's Only Explicitly Known Proof by Descente Infinie}.
    Seki Working-Paper (2006): n.\ pag. Web.

\bibitem{Kleiner}
    Kleiner, Israel.
    \emph{From Fermat to Wiles: Fermat's Last Theorem Becomes a Theorem}.
    Elemente Der Mathematik 55.1 (2000): 19-37. Print.

\bibitem{Euclid}
    Euclid. Euclid's Elements;. N.p.: Dutton, 1933. Print.

\bibitem{Miller}
    Miller, Gary L.
    \emph{Riemann's Hypothesis and Tests for Primality}.
    Journal of Computer and System Sciences 13.3 (1976): 300-17. Print.

\bibitem{MersennePrimeTests}
    Jason Wojciechowski.
    \emph{Mersenne Primes, An Introduction and Overview}. 2003.

%\bibitem{wFermat}
%    \emph{Pierre De Fermat}. Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{PerfectNumbers}
    \emph{Perfect Numbers}. Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{Mersenne}
    Bernstein, Peter L. (1996).
    \emph{Against the Gods: The Remarkable Story of Risk}. John Wiley \& Sons.\ p. 59.
%nbibitem{wFermatsLittleThereom}
%    \emph{Fermat's Little Theorem}.  Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

%\bibitem{wFermatsLastTheorem}
%    \emph{Fermat's Last Theorem}.  Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{FermatTest}
    \emph{Fermat Primality Test}. Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{wLucasLehmerTest}
    \emph{Lucas-Lehmer Primality Test}.  Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{wMillerRabinTest}
    \emph{Miller-Rabin Primality Test}.  Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{MersennePrime}
    \emph{Mersenne Primes}. Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{Huygens}
    \emph{Christiaan Huygens}. Wikipedia. Wikipedia, n.d. Web. $<$wikipedia.org$>$.

\bibitem{Taniyama}
    \emph{Taniyama-Shimura}. Wolfram. Wolfram, n.d. Web. $<$http://mathworld.wolfram.com$>$.
\end{thebibliography}

\end{document}

